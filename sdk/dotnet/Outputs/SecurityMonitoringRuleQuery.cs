// *** WARNING: this file was generated by pulumi-language-dotnet. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;

namespace Pulumi.Datadog.Outputs
{

    [OutputType]
    public sealed class SecurityMonitoringRuleQuery
    {
        /// <summary>
        /// **Deprecated**. It won't be applied anymore. **Deprecated.** `agent_rule` has been deprecated in favor of new Agent Rule resource.
        /// </summary>
        public readonly ImmutableArray<Outputs.SecurityMonitoringRuleQueryAgentRule> AgentRules;
        /// <summary>
        /// The aggregation type. For Signal Correlation rules, it must be event_count. Valid values are `count`, `cardinality`, `sum`, `max`, `new_value`, `geo_data`, `event_count`, `none`. Defaults to `"count"`.
        /// </summary>
        public readonly string? Aggregation;
        /// <summary>
        /// Source of events. Valid values are `logs`, `audit`, `app_sec_spans`, `spans`, `security_runtime`, `network`, `events`. Defaults to `"logs"`.
        /// </summary>
        public readonly string? DataSource;
        /// <summary>
        /// Field for which the cardinality is measured. Sent as an array.
        /// </summary>
        public readonly ImmutableArray<string> DistinctFields;
        /// <summary>
        /// Fields to group by.
        /// </summary>
        public readonly ImmutableArray<string> GroupByFields;
        /// <summary>
        /// When false, events without a group-by value are ignored by the rule. When true, events with missing group-by fields are processed with `N/A`, replacing the missing values. Defaults to `false`.
        /// </summary>
        public readonly bool? HasOptionalGroupByFields;
        /// <summary>
        /// List of indexes to run the query on when the data source is `logs`. Supports only one element. Used only for scheduled rules (in other words, when `scheduling_options` is defined).
        /// </summary>
        public readonly ImmutableArray<string> Indexes;
        /// <summary>
        /// The target field to aggregate over when using the `sum`, `max`, or `geo_data` aggregations. **Deprecated.** Configure `metrics` instead. This attribute will be removed in the next major version of the provider.
        /// </summary>
        public readonly string? Metric;
        /// <summary>
        /// Group of target fields to aggregate over when using the `sum`, `max`, `geo_data`, or `new_value` aggregations. The `sum`, `max`, and `geo_data` aggregations only accept one value in this list, whereas the `new_value` aggregation accepts up to five values.
        /// </summary>
        public readonly ImmutableArray<string> Metrics;
        /// <summary>
        /// Name of the query. Not compatible with `new_value` aggregations.
        /// </summary>
        public readonly string? Name;
        /// <summary>
        /// Query to run on logs.
        /// </summary>
        public readonly string Query;

        [OutputConstructor]
        private SecurityMonitoringRuleQuery(
            ImmutableArray<Outputs.SecurityMonitoringRuleQueryAgentRule> agentRules,

            string? aggregation,

            string? dataSource,

            ImmutableArray<string> distinctFields,

            ImmutableArray<string> groupByFields,

            bool? hasOptionalGroupByFields,

            ImmutableArray<string> indexes,

            string? metric,

            ImmutableArray<string> metrics,

            string? name,

            string query)
        {
            AgentRules = agentRules;
            Aggregation = aggregation;
            DataSource = dataSource;
            DistinctFields = distinctFields;
            GroupByFields = groupByFields;
            HasOptionalGroupByFields = hasOptionalGroupByFields;
            Indexes = indexes;
            Metric = metric;
            Metrics = metrics;
            Name = name;
            Query = query;
        }
    }
}
