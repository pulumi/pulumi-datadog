// *** WARNING: this file was generated by pulumi-language-dotnet. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;

namespace Pulumi.Datadog.Inputs
{

    public sealed class SecurityMonitoringDefaultRuleQueryArgs : global::Pulumi.ResourceArgs
    {
        [Input("agentRules")]
        private InputList<Inputs.SecurityMonitoringDefaultRuleQueryAgentRuleArgs>? _agentRules;

        /// <summary>
        /// **Deprecated**. It won't be applied anymore. **Deprecated.** `AgentRule` has been deprecated in favor of new Agent Rule resource.
        /// </summary>
        [Obsolete(@"`AgentRule` has been deprecated in favor of new Agent Rule resource.")]
        public InputList<Inputs.SecurityMonitoringDefaultRuleQueryAgentRuleArgs> AgentRules
        {
            get => _agentRules ?? (_agentRules = new InputList<Inputs.SecurityMonitoringDefaultRuleQueryAgentRuleArgs>());
            set => _agentRules = value;
        }

        /// <summary>
        /// The aggregation type. For Signal Correlation rules, it must be event_count. Valid values are `Count`, `Cardinality`, `Sum`, `Max`, `NewValue`, `GeoData`, `EventCount`, `None`.
        /// </summary>
        [Input("aggregation")]
        public Input<string>? Aggregation { get; set; }

        /// <summary>
        /// Query extension to append to the logs query.
        /// </summary>
        [Input("customQueryExtension")]
        public Input<string>? CustomQueryExtension { get; set; }

        /// <summary>
        /// Source of events. Valid values are `Logs`, `Audit`, `AppSecSpans`, `Spans`, `SecurityRuntime`, `Network`, `Events`.
        /// </summary>
        [Input("dataSource")]
        public Input<string>? DataSource { get; set; }

        [Input("distinctFields")]
        private InputList<string>? _distinctFields;

        /// <summary>
        /// Field for which the cardinality is measured. Sent as an array.
        /// </summary>
        public InputList<string> DistinctFields
        {
            get => _distinctFields ?? (_distinctFields = new InputList<string>());
            set => _distinctFields = value;
        }

        [Input("groupByFields")]
        private InputList<string>? _groupByFields;

        /// <summary>
        /// Fields to group by.
        /// </summary>
        public InputList<string> GroupByFields
        {
            get => _groupByFields ?? (_groupByFields = new InputList<string>());
            set => _groupByFields = value;
        }

        /// <summary>
        /// When false, events without a group-by value are ignored by the rule. When true, events with missing group-by fields are processed with `N/A`, replacing the missing values.
        /// </summary>
        [Input("hasOptionalGroupByFields")]
        public Input<bool>? HasOptionalGroupByFields { get; set; }

        /// <summary>
        /// The target field to aggregate over when using the `Sum`, `Max`, or `GeoData` aggregations. **Deprecated.** Configure `Metrics` instead. This attribute will be removed in the next major version of the provider.
        /// </summary>
        [Input("metric")]
        public Input<string>? Metric { get; set; }

        [Input("metrics")]
        private InputList<string>? _metrics;

        /// <summary>
        /// Group of target fields to aggregate over when using the `Sum`, `Max`, `GeoData`, or `NewValue` aggregations. The `Sum`, `Max`, and `GeoData` aggregations only accept one value in this list, whereas the `NewValue` aggregation accepts up to five values.
        /// </summary>
        public InputList<string> Metrics
        {
            get => _metrics ?? (_metrics = new InputList<string>());
            set => _metrics = value;
        }

        /// <summary>
        /// Name of the query. Not compatible with `NewValue` aggregations.
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// Query to run on logs.
        /// </summary>
        [Input("query")]
        public Input<string>? Query { get; set; }

        public SecurityMonitoringDefaultRuleQueryArgs()
        {
        }
        public static new SecurityMonitoringDefaultRuleQueryArgs Empty => new SecurityMonitoringDefaultRuleQueryArgs();
    }
}
